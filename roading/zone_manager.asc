// new module script

void ZoneManager::UpdateCurrentPos(float x, float z)
{
  this.PreviousX = this.CurrentX;
  this.PreviousY = this.CurrentY;
  
  this.CurrentX = (FloatToInt(x) + this.WorldWidth/2) / (this.WorldWidth/this.ZoneXYCount);
  this.CurrentY = (FloatToInt(z) + this.WorldHeight/2)  / (this.WorldHeight/this.ZoneXYCount);
  
  this.ZoneChanged = this.CurrentX != this.PreviousX || this.CurrentY != this.PreviousY;
}

Mode7Object* ZoneManager::AddObject(int x, int z, float factor, int graphic)
{
  if (this.ObjectCount == MAX_OBJECTS) return null;
  this.Objects[this.ObjectCount] = new Mode7Object;
  this.Objects[this.ObjectCount].Visible = true;
  this.Objects[this.ObjectCount].X = IntToFloat(x);
  this.Objects[this.ObjectCount].Y = 0.0;
  this.Objects[this.ObjectCount].Z = IntToFloat(z);
  this.Objects[this.ObjectCount].Factor = factor;
  this.Objects[this.ObjectCount].Graphic = graphic;
  this.ObjectCount++;
  return this.Objects[this.ObjectCount-1];
}